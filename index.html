<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>지원금 잔여 내역 조회</title>
<style>
body { font-family:sans-serif; padding:20px; background:#f5f5f5;}
input,button { padding:10px; margin:5px; font-size:16px; }
</style>
</head>
<body>
<h2>지원금 잔여 내역 조회</h2>
<input id="name" placeholder="이름">
<input id="pw" placeholder="비밀번호" type="password">
<button onclick="check()">조회</button>
<p id="result"></p>

<script>
const SHEET_ID = "1oupd4NwonWpdc5RocP5GQoY5SIyGFI_z_OIhWmjTKek/edit?gid=0#gid=0"; 
const URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json`;

async function fetchData() {
  const res = await fetch(URL);
  const text = await res.text();
  const json = JSON.parse(text.substr(47).slice(0,-2));
  const rows = json.table.rows;
  const data = {};
  for (let r of rows.slice(1)) { 
    const name = r.c[0]?.v;
    const pw = r.c[1]?.v.toString();
    const balance = r.c[5]?.v; // J열 (6번째 컬럼)
    data[name] = { pw, balance };
  }
  return data;
}

async function check() {
  const name = document.getElementById('name').value.trim();
  const pw = document.getElementById('pw').value.trim();
  const result = document.getElementById('result');

  const data = await fetchData();
  if (data[name] && data[name].pw === pw) {
    result.innerText = `${name}님의 잔여 지원금: ${data[name].balance}원`;
  } else {
    result.innerText = "이름이나 비밀번호가 틀렸습니다.";
  }
}
</script>
</body>
</html>
